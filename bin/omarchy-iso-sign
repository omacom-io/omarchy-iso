#!/bin/bash

if [ $# -eq 0 ]; then
  echo "usage: omarchy-iso-sign [release/omarchy.iso]"
  exit 1
fi

if ! pacman -Q gnupg >/dev/null; then
  sudo pacman -S --noconfirm --needed --quiet gnupg
  echo "you'll need to generate a new key with: gpg --full-generate-key"
fi

gnupg_user_key=$(gpg --list-secret-keys --keyid-format=long | awk '/^[[:space:]]/{print $1; exit}')
gpg --local-user "$gnupg_user_key" --output $1.sig --detach-sig $1
